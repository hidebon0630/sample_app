<div class="sm-page">
  <%= form_for(@post) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="form-group">
      <%= f.label :title, class:"bmd-label-floating" %>
      <%= f.text_field :title, class: 'form-control' %>
      <span class="bmd-help">30文字以内で入力してください</span>
    </div>
    <div class="form-group">
      <%= f.label :option, "質問1", class:"bmd-label-floating" %>
      <%= text_field_tag "options[][title]", @option.title, autocomplete: "off", class: 'form-control' %>
      <span class="bmd-help">同じ質問は結果が重複されます。</span>
    </div>
    <div class="form-group">
      <%= f.label :option, "質問2", class:"bmd-label-floating" %>
      <%= text_field_tag "options[][title]", @option.title, autocomplete: "off", class: 'form-control' %>
      <span class="bmd-help">同じ質問は結果が重複されます。</span>
    </div>
    <div class="form-group">
      <%= f.label :option, "質問3", class:"bmd-label-floating" %>
      <%= text_field_tag "options[][title]", @option.title, autocomplete: "off", class: 'form-control' %>
      <span class="bmd-help">同じ質問は結果が重複されます。</span>
    </div>
    <div class="form-group">
      <%= f.label :tag_list, class:"bmd-label-floating" %>
      <%= f.text_field :tag_list, value: @post.tag_list.join(','), class: "form-control" %>
      <span class="bmd-help">" , "で区切ると複数選択出来ます。</span>
    </div>
    <div class="form-group">
      <%= f.label :image, class:"bmd-label-floating" %>
        <% if @post.image.present? %>
          <%= image_tag @post.image_url, id: :img_prev %>
        <% else %>
          <%= image_tag "default.png", :size => '300x300', id: :img_prev %>
        <% end %>
      <button type="button" class="btn btn-outline-secondary">
        <%= f.file_field :image, accept: 'image/jpeg,image/gif,image/png', id: :post_img %>
      </button>
    </div>
    <div class="form-group">
      <%= f.label :status, class:"bmd-label-floating" %>
      <%= f.select :status, Post.statuses.keys.map {|k| [I18n.t("enums.post.status.#{k}"), k]}, {}, class: 'form-control' %>
    </div>
    <%= f.submit "投稿", class: "btn btn-primary btn-raised btn-block" %>
  <% end %>
</div>

<script type="text/javascript">
  $('#post_image').bind('change', function() {
    var size_in_megabytes = this.files[0].size/1024/1024;
    if (size_in_megabytes > 5) {
      alert('Maximum file size is 5MB. Please choose a smaller file.');
    }
  });
</script>

<script type="text/javascript">
  $(function() {
    function readURL(input) {
        if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
    $('#img_prev').attr('src', e.target.result);
        }
        reader.readAsDataURL(input.files[0]);
        }
    }
    $("#post_img").change(function(){
        readURL(this);
    });
  });
</script>
